<ion-header>
  <ion-toolbar>
    <ion-title>
      <mat-form-field>
        <mat-select value="selected">
          <mat-option value="selected">{{name}}</mat-option>
          <mat-option value="latest">Semester 1</mat-option>
        </mat-select>
      </mat-form-field>
    </ion-title>
    <ion-buttons slot="end" *ngIf="subjectColors">
      <button mat-icon-button [matMenuTriggerFor]="colors">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #colors="matMenu" overlapTrigger="true">
        <ng-container *ngFor="let sub of keys(subjectColors)">
          <button mat-menu-item>
            <mat-icon [style.color]="subjectColors[sub]">fiber_manual_record</mat-icon>
            <span>{{sub}}</span>
          </button>
        </ng-container>
      </mat-menu>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="table-container">
    <app-loader *ngIf="!dataSource"></app-loader>
    <table class="mat-table" *ngIf="dataSource">
      <thead>
        <tr class="mat-header-row">
          <th class="mat-header-cell"></th>
          <th *ngFor="let column of displayedColumns" class="mat-header-cell">
            {{column}}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let week of dataSource; index as i" class="mat-row">
          <th class="mat-header-cell">
            <span [attr.starttime]="breakpoints[i]" [attr.endtime]="breakpoints[i+1]">
              {{ i + 1 }}
            </span>
          </th>
          <td *ngFor="let period of week" [attr.rowspan]="period.rowspan" class="mat-cell period">
            <p class="period--button" *ngIf="period.room" [style.background]="period.color">
              {{period.room}}
            </p>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</ion-content>